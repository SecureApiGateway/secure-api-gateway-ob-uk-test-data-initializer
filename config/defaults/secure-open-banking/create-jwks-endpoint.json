{"type": "text/javascript","source":"(function(){ logger.debug(\"APICLIENTJWKS starting\"); var apiClients = openidm.query(\"managed/apiClient\", { \"_queryFilter\": \"true\"}, [\"jwks\",\"jwksUri\"]); signingKeys = []; apiClients.result.forEach(function(apiClient) { logger.debug(\"APICLIENTJWKS fetching jwksuri\" + apiClient.jwksUri); jwks = apiClient.jwks;if (jwks == null || jwks.length == 0) {jwks = openidm.action(\"external/rest\",\"call\",{ \"url\" : apiClient.jwksUri, \"method\": \"GET\" }).body; }jwksObject = JSON.parse(jwks); jwksObject.keys.forEach(function(key) { if (key.use == \"sig\") { signingKeys.push(key); } }) }); return { \"keys\" : signingKeys }; })();"}